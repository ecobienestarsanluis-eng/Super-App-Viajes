<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Global Tierra — Dashboard CRM (Mockup)</title>

  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body { font-family: 'Nunito', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background: #f7f6f4; }
    .brand-bg { background: linear-gradient(90deg,#2f5d43,#083b4c); }
    .card { background: linear-gradient(180deg,#ffffff,#fbfbfa); border:1px solid rgba(15,23,42,0.04); border-radius:12px; box-shadow: 0 6px 20px rgba(15,23,42,0.06); }
    .small-glyph { width:36px; height:36px; display:inline-flex; align-items:center; justify-content:center; border-radius:8px; background:rgba(47,93,67,0.08); }
    .pulse { animation: pulse 2s infinite; }
    @keyframes pulse { 0% { transform: scale(1) } 50% { transform: scale(1.03) } 100% { transform: scale(1) } }
  </style>
</head>
<body class="min-h-screen">

  <div class="flex">
    <!-- Sidebar -->
    <aside class="w-72 brand-bg text-white min-h-screen p-6">
      <div class="flex items-center gap-3 mb-8">
        <div class="w-12 h-12 bg-[linear-gradient(180deg,#d69b3a,#b37a2a)] rounded-full flex items-center justify-center shadow">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 3C8.13 3 5 6.13 5 10c0 2.93 2.12 5.36 5 5.9V17c-3.31 0-6-2.69-6-6 0-3.31 2.69-6 6-6s6 2.69 6 6c0 1.1-.9 2-2 2h-1" stroke="#fff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <div>
          <div class="font-extrabold" style="font-family:'Cormorant Garamond', serif;">Global Tierra</div>
          <div class="text-xs text-white/80">CRM · Operaciones</div>
        </div>
      </div>

      <nav class="space-y-2">
        <a href="#" class="block py-2 px-3 rounded-lg bg-white/10">Leads</a>
        <a href="#" class="block py-2 px-3 rounded-lg hover:bg-white/5">Reservas</a>
        <a href="#" class="block py-2 px-3 rounded-lg hover:bg-white/5">Notificaciones</a>
        <a href="#" class="block py-2 px-3 rounded-lg hover:bg-white/5">Usuarios</a>
        <a href="#" class="block py-2 px-3 rounded-lg hover:bg-white/5">Reportes</a>
      </nav>

      <div class="mt-8">
        <div class="text-xs text-white/80 mb-2">KPIs rápidos</div>
        <div class="grid grid-cols-1 gap-3">
          <div class="p-3 rounded-lg bg-white/10">
            <div class="text-xs">Leads activos</div>
            <div class="text-2xl font-bold">128</div>
          </div>
          <div class="p-3 rounded-lg bg-white/10">
            <div class="text-xs">Reservas hoy</div>
            <div class="text-2xl font-bold">7</div>
          </div>
          <div class="p-3 rounded-lg bg-white/10">
            <div class="text-xs">Mensajes enviados</div>
            <div class="text-2xl font-bold">3,412</div>
          </div>
        </div>
      </div>

      <div class="mt-8 text-xs text-white/80">
        <div class="mb-2">Contacto</div>
        <div>maurodestinodeveloper@gmail.com</div>
        <div class="mt-2">WhatsApp: +57 3239157120</div>
      </div>
    </aside>

    <!-- Main -->
    <main class="flex-1 p-8">
      <!-- Header -->
      <header class="flex items-center justify-between mb-6">
        <div>
          <h2 class="text-2xl font-extrabold">Panel Operativo</h2>
          <p class="text-sm text-gray-600">Visión general — leads, reservas y notificaciones multicanal</p>
        </div>

        <div class="flex items-center gap-4">
          <button id="btnAddLead" class="px-4 py-2 bg-amber-500 text-white rounded-lg hover:opacity-95">+ Agregar Lead</button>
          <button id="btnConfirm" class="px-4 py-2 bg-emerald-600 text-white rounded-lg hover:opacity-95">Confirmar Reserva</button>
        </div>
      </header>

      <!-- KPI cards -->
      <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <div class="card p-4">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-xs text-gray-500">Reservas (últimos 12 meses)</div>
              <div class="text-xl font-bold">1,428</div>
            </div>
            <div class="small-glyph"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 7h18" stroke="#2f5d43" stroke-width="1.6" stroke-linecap="round"/></svg></div>
          </div>
          <canvas id="chartReservas" class="mt-3" height="120"></canvas>
        </div>

        <div class="card p-4">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-xs text-gray-500">Leads convertidos</div>
              <div class="text-xl font-bold">34%</div>
            </div>
            <div class="small-glyph"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 2v20" stroke="#b37a2a" stroke-width="1.6" stroke-linecap="round"/></svg></div>
          </div>
          <canvas id="chartLeads" class="mt-3" height="120"></canvas>
        </div>

        <div class="card p-4">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-xs text-gray-500">Mensajes enviados (mensual)</div>
              <div class="text-xl font-bold">3,412</div>
            </div>
            <div class="small-glyph"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M2 12h20" stroke="#083b4c" stroke-width="1.6" stroke-linecap="round"/></svg></div>
          </div>
          <canvas id="chartMensajes" class="mt-3" height="120"></canvas>
        </div>
      </section>

      <!-- Lists -->
      <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="card p-4">
          <div class="flex items-center justify-between mb-3">
            <div class="font-semibold">Leads recientes</div>
            <div class="text-xs text-gray-500">Actualizado en tiempo real</div>
          </div>
          <ul id="leadsList" class="space-y-3 max-h-64 overflow-auto">
            <!-- items injected by JS -->
          </ul>
        </div>

        <div class="card p-4">
          <div class="flex items-center justify-between mb-3">
            <div class="font-semibold">Notificaciones (historial)</div>
            <div class="text-xs text-gray-500">Correo · WhatsApp</div>
          </div>
          <ul id="notifications" class="space-y-3 max-h-64 overflow-auto text-sm text-gray-700">
            <!-- items injected by JS -->
          </ul>
        </div>
      </section>

      <footer class="mt-8 text-gray-500 text-sm">
        © 2026 Global Tierra — Panel CRM. Accesible, inclusivo y con estética ancestral‑moderna.
      </footer>
    </main>
  </div>

  <script>
    // Mock fetch of KPIs (from data/kpis.json or inline)
    const kpisURL = './data/kpis.json';

    async function fetchKpis(){
      try{
        const res = await fetch(kpisURL);
        if(!res.ok) throw new Error('No data');
        return await res.json();
      }catch(e){
        // fallback sample
        return {
          reservasPorMes: [40,50,60,45,70,80,75,90,100,95,110,98],
          meses: ["Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic","Ene","Feb"],
          leads: {convertidos: 34, noConvertidos: 66},
          mensajesMensual: [200,220,250,230,260,300,310,320,340,350,400,412],
          leadsRecientes: [
            {"nombre":"Cliente Demo","correo":"cliente@demo.com","telefono":"+573001234567","interes":"Rafting Río Samaná"},
            {"nombre":"Ana Perez","correo":"ana@ejemplo.com","telefono":"+573229998877","interes":"Senderismo La Cuba"}
          ],
          notifications: [
            {"tipo":"email","texto":"Confirmación enviada a cliente@demo.com","ts":"2 min"},
            {"tipo":"whatsapp","texto":"WhatsApp enviado a +573001234567","ts":"5 min"}
          ]
        };
      }
    }

    (async function init(){
      const data = await fetchKpis();

      // Chart: Reservas (bar)
      const ctx1 = document.getElementById('chartReservas').getContext('2d');
      new Chart(ctx1, {
        type: 'bar',
        data: {
          labels: data.meses,
          datasets: [{
            label: 'Reservas',
            data: data.reservasPorMes,
            backgroundColor: 'rgba(47,93,67,0.85)'
          }]
        },
        options: { responsive:true, plugins:{legend:{display:false}} }
      });

      // Chart: Leads (doughnut)
      const ctx2 = document.getElementById('chartLeads').getContext('2d');
      new Chart(ctx2, {
        type: 'doughnut',
        data: {
          labels: ['Convertidos','No convertidos'],
          datasets: [{ data: [data.leads.convertidos, data.leads.noConvertidos], backgroundColor: ['#b37a2a','#cbd5e1'] }]
        },
        options: { responsive:true, plugins:{legend:{position:'bottom'}} }
      });

      // Chart: Mensajes (line)
      const ctx3 = document.getElementById('chartMensajes').getContext('2d');
      new Chart(ctx3, {
        type: 'line',
        data: {
          labels: data.meses,
          datasets: [{ label:'Mensajes', data: data.mensajesMensual, borderColor: '#083b4c', backgroundColor: 'rgba(8,59,76,0.08)', tension:0.3 }]
        },
        options: { responsive:true, plugins:{legend:{display:false}} }
      });

      // Populate lists
      const leadsList = document.getElementById('leadsList');
      leadsList.innerHTML = data.leadsRecientes.map(l => `
        <li class="flex items-start justify-between gap-3 p-3 rounded-md border">
          <div>
            <div class="font-semibold">${l.nombre}</div>
            <div class="text-xs text-gray-600">${l.correo} · ${l.telefono}</div>
            <div class="text-xs text-gray-500 mt-1">Interés: ${l.interes}</div>
          </div>
          <div class="flex flex-col items-end gap-2">
            <button class="px-3 py-1 text-xs rounded bg-amber-100">Asignar</button>
            <button class="px-3 py-1 text-xs rounded bg-emerald-100">Contactar</button>
          </div>
        </li>
      `).join('');

      const notif = document.getElementById('notifications');
      notif.innerHTML = data.notifications.map(n => `
        <li class="p-2 rounded border flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="text-xs text-gray-500">${n.tipo.toUpperCase()}</div>
            <div>${n.texto}</div>
          </div>
          <div class="text-xs text-gray-400">${n.ts}</div>
        </li>
      `).join('');

      // Simulate live updates: every 8s add a fake lead & notification
      setInterval(()=> {
        const nowLead = { nombre: "Nuevo Lead "+Math.floor(Math.random()*900), correo: "nuevo@demo.com", telefono: "+57 300"+Math.floor(Math.random()*9000000), interes: "Aventura" };
        data.leadsRecientes.unshift(nowLead);
        if(data.leadsRecientes.length>10) data.leadsRecientes.pop();
        leadsList.innerHTML = data.leadsRecientes.map(l => `
          <li class="flex items-start justify-between gap-3 p-3 rounded-md border">
            <div>
              <div class="font-semibold">${l.nombre}</div>
              <div class="text-xs text-gray-600">${l.correo} · ${l.telefono}</div>
              <div class="text-xs text-gray-500 mt-1">Interés: ${l.interes}</div>
            </div>
            <div class="flex flex-col items-end gap-2">
              <button class="px-3 py-1 text-xs rounded bg-amber-100">Asignar</button>
              <button class="px-3 py-1 text-xs rounded bg-emerald-100">Contactar</button>
            </div>
          </li>
        `).join('');
        // add notification
        data.notifications.unshift({ tipo:'whatsapp', texto:'WhatsApp a '+nowLead.telefono, ts: 'ahora' });
        if(data.notifications.length>12) data.notifications.pop();
        notif.innerHTML = data.notifications.map(n => `
          <li class="p-2 rounded border flex items-center justify-between">
            <div class="flex items-center gap-2">
              <div class="text-xs text-gray-500">${n.tipo.toUpperCase()}</div>
              <div>${n.texto}</div>
            </div>
            <div class="text-xs text-gray-400">${n.ts}</div>
          </li>
        `).join('');
      }, 8000);

      // Buttons demo
      document.getElementById('btnAddLead').addEventListener('click', ()=> alert('Abrir modal: Agregar lead (demo)'));
      document.getElementById('btnConfirm').addEventListener('click', ()=> alert('Abrir modal: Confirmar reserva (demo)'));
    })();
  </script>
</body>
</html>
